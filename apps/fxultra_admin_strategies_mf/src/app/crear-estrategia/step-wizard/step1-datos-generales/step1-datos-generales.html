<!-- apps/fxultra_admin_strategies_mf/src/app/crear-estrategia/step-wizard/step1-datos-generales/step1-datos-generales.html -->
<!-- datos-generales.component.html — COMPLETO -->
<div class="datos-generales-container">
  <!-- ===== Campos principales ===== -->
  <div class="d-flex align-items-end mb-3" style="gap: 12px;">
    <div class="form-group" style="min-width:220px; position:relative;">
      <label
        for="nombre-estrategia"
        [ngStyle]="{ color: errorNombreExiste ? '#D22419' : (errorNombreVacio ? '#D22419' : '#000') }"
      >
        Nombre de estrategia <span class="req">*</span>
      </label>
      <input
        id="nombre-estrategia"
        type="text"
        class="form-control"
        placeholder="Escribe nombre"
        [(ngModel)]="nombreEstrategia"
        (input)="onNombreEstrategiaInput()"
        (focus)="onNombreFocus()"
        (blur)="onNombreBlur()"
        [ngClass]="{
          'input-error': errorNombreExiste || errorNombreVacio,
          'input-activo': isNombreFocused && !errorNombreExiste && !errorNombreVacio
        }"
        autocomplete="off"
        maxlength="50"
      >
      <div *ngIf="errorNombreExiste" class="mensaje-error">
        <i class="fas fa-exclamation-circle"></i>
        <span class="strong">Nombre ya existe</span>, por favor modifica
      </div>
      <div *ngIf="!errorNombreExiste && errorNombreVacio" class="mensaje-error">
        <i class="fas fa-exclamation-circle"></i>
        <span class="strong">Elige el nombre</span> para la estrategia
      </div>
      <div *ngIf="!errorNombreExiste && !errorNombreVacio" class="mensaje-error-placeholder"></div>
    </div>

    <div class="form-group select-group" style="min-width:220px; position:relative;">
      <label
        for="producto-asociado"
        [ngStyle]="{ color: errorProductoAsociado ? '#D22419' : '#000' }"
      >
        Producto asociado <span class="req">*</span>
      </label>
      <div class="select-dropdown-wrapper">
        <select
          id="producto-asociado"
          class="form-control"
          [(ngModel)]="productoAsociado"
          [ngClass]="{
            'input-error': errorProductoAsociado,
            'input-activo': isProductoFocused && !errorProductoAsociado
          }"
          (focus)="onProductoFocus()"
          (blur)="onProductoBlur()"
          (change)="onProductoAsociadoChange()"
        >
          <option disabled [selected]="productoAsociado === ''" value="">Selecciona producto</option>
          <option [disabled]="!nombreEstrategiaValido" value="Compra venta">Compra venta</option>
          <option [disabled]="!nombreEstrategiaValido" value="DPAS">DPAS</option>
          <option [disabled]="!nombreEstrategiaValido" value="Forwards">Forwards</option>
          <option [disabled]="!nombreEstrategiaValido" value="Posturas">Posturas</option>
        </select>
        <span class="chevron-icon">
          <i class="fas fa-chevron-down"></i>
        </span>
      </div>
      <div *ngIf="errorProductoAsociado" class="mensaje-error">
        <i class="fas fa-exclamation-circle"></i>
        <span class="strong">Elige el producto asociado</span> a la estrategia
      </div>
      <div *ngIf="!errorProductoAsociado" class="mensaje-error-placeholder"></div>
    </div>
  </div>

  <!-- ===== Descripción ===== -->
  <div class="form-group descripcion-estrategia-group" style="width: 462px;">
    <label for="descripcion"
      [ngStyle]="{ color: errorDescripcionVacia ? '#D22419' : '#000' }">
      Descripción <span class="req">*</span>
    </label>
    <textarea
      id="descripcion"
      class="form-control"
      placeholder="Breve descripción de la estrategia que explica su configuración y en qué casos utilizarla."
      style="width: 100%; height: 85px; resize: none;"
      maxlength="250"
      [(ngModel)]="descripcion"
      [ngClass]="{
        'input-error': errorDescripcionVacia,
        'input-activo': isDescripcionFocused && !errorDescripcionVacia
      }"
      (input)="onDescripcionInput()"
      (focus)="onDescripcionFocus()"
      (blur)="onDescripcionBlur()"
    ></textarea>
    <div *ngIf="errorDescripcionVacia" class="mensaje-error">
      <i class="fas fa-exclamation-circle"></i>
      <span class="strong">Elige la descripción</span> para la estrategia
    </div>
    <div *ngIf="!errorDescripcionVacia" class="mensaje-error-placeholder"></div>
  </div>

  <!-- ===== Checkbox fijo ===== -->
  <div class="operacion-horarios-group">
    <label class="operar-label">Tu estrategia necesita operar por:</label>
    <div class="checkbox-group">
      <label class="custom-checkbox-label">
        <input type="checkbox" class="custom-checkbox" [checked]="true" [disabled]="true" tabindex="-1" />
        <span class="checkbox-custom"></span>
        <span>Horarios establecidos</span>
      </label>
    </div>
  </div>

  <!-- ===== Error general ===== -->
  <div *ngIf="errorMsg" class="mensaje-error" style="margin-bottom: 6px;">
    <i class="fas fa-exclamation-circle"></i>
    {{ errorMsg }}
  </div>

  <!-- ===== Acciones ===== -->
  <div class="acciones">
    <button class="btn-principal" (click)="aplicarConfiguracion()" [disabled]="loading">
      Aplicar configuración
    </button>
    <span class="descartar-cambios" (click)="descartarCambios()">Reestablecer</span>
  </div>
  <div class="progreso">Paso 1 de 7</div>
</div>

<!-- ===== Modal OK pequeño (solo cuando vienes de edición) ===== -->
<div class="modal-backdrop" *ngIf="mostrarModalOk" (click)="cerrarModalOk()"></div>
<div
  class="modal-contenedor modal-ok-peq"
  *ngIf="mostrarModalOk"
  role="dialog"
  aria-modal="true"
  aria-label="Datos actualizados"
  (click)="$event.stopPropagation()"
>
  <button
    class="modal-cerrar"
    type="button"
    (click)="cerrarModalOk(); $event.stopPropagation()"
    aria-label="Cerrar"
    title="Cerrar"
  >
    <svg class="modal-cerrar__icon" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M18 6L6 18M6 6l12 12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
    </svg>
  </button>

  <div class="modal-body modal-ok__body-peq">
    <div class="modal-titulo modal-ok__titulo-peq">Datos actualizados exitosamente</div>
    <div class="modal-footer">
      <button class="btn-principal btn-modal btn-modal--peq" (click)="cerrarModalOk()">Aceptar</button>
    </div>
  </div>
</div>
